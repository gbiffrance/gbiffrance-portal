#{extends 'main.html' /}
#{include 'Application/Search/bar.html' /}
#{set title:'Home' /}
<script src="@{'/public/javascripts/search/search.js'}"></script>
<script type="text/javascript" >
  var taxas = #{jsAction @Taxas.search(':search', ':page') /}  
  var occurrences = #{jsAction @Occurrences.search(':searchTaxa', ':searchPlace', ':searchDataset', ':onlyWithCoordinates', ':from') /}  
  var places = #{jsAction @Places.search(':search') /}
  var datasets = #{jsAction @Datasets.search(':search') /}
 
  $(document).ready(function() {
    searchOccurrences("${search.taxaText}", "${search.placeText}", "${search.dataset}", "${search.onlyWithCoordinates}", 0)
    searchTaxas("${search.taxaText}",'1');
    searchPlaces("${search.placeText}", 0);
    searchDatasets("${search.dataset}");
  });
</script>

<div class="container">
  <div id="datasets"></div>
  <div id="places"></div>
  <div id="taxas"></div>
  #{if dataPublishers}
  <div style="margin-top:20px;">
    <h3>Institutions</h3>
    <table class="table table-condensed table-striped">
    #{list items:dataPublishers, as:'dataPublisher'}
      <td><a href="@{DataPublishers.show(dataPublisher.id)}">${dataPublisher.name}</a></td>
    #{/list}
    </table>
  </div>
  #{/if}
  
  <div id="occurrences"></div> 
</div>